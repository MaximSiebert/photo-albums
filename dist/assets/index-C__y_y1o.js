(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function a(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(s){if(s.ep)return;s.ep=!0;const o=a(s);fetch(s.href,o)}})();const e={view:"index",currentAlbum:null,currentPhoto:1,albums:{},sortBy:"date-desc",overlayOpen:!1,searchQuery:"",selectedAlbumIndex:-1,navVisible:!0,selectedOverlayIndex:-1,scrollPosition:0};function H(){const n=window.location.hash.slice(1);if(!n){e.view="index",e.currentAlbum=null,e.currentPhoto=1;return}const t=n.split("/");if(t.length===2){const[a,l]=t,s=decodeURIComponent(a),o=parseInt(l,10);e.albums[s]&&o>0&&(e.currentAlbum=s,e.currentPhoto=Math.min(o,e.albums[s].photos.length),e.view="viewer")}}function x(){e.view==="viewer"&&e.currentAlbum?window.location.hash=`${encodeURIComponent(e.currentAlbum)}/${e.currentPhoto}`:window.location.hash=""}async function W(n){try{const a=await(await fetch("./albums/albums.json")).json();for(const l of a.albums)try{const o=await(await fetch(`./albums/${l}/photos.json`)).json();e.albums[l]={name:o.name||l,photos:o.photos,created:o.created||null}}catch(s){console.error(`Failed to load album ${l}:`,s)}H(),n()}catch(t){console.error("Failed to load albums:",t),document.getElementById("app").innerHTML="<p>Error loading albums. Make sure /albums/albums.json exists.</p>"}}const Y="https://ik.imagekit.io/splitfocus/albums";function P(n,t={}){const{width:a=null,height:l=null,quality:s=85,format:o="auto"}=t,r=[];a&&r.push(`w-${a}`),l&&r.push(`h-${l}`),r.push(`q-${s}`),r.push(`f-${o}`);const c=r.join(",");return`${Y}/tr:${c}${n}`}function D(n,t,a=85){return t.map(l=>`${P(n,{width:l,quality:a,format:"auto"})} ${l}w`).join(", ")}function G(n){const t=n.albums[n.currentAlbum];if(!(!t||n.currentPhoto>=t.photos.length))for(let a=1;a<=5;a++){const l=n.currentPhoto+a-1;if(l>=t.photos.length)break;const s=t.photos[l];if(!s)continue;const o=typeof s=="string"?s:s.filename,r=`/albums/${encodeURIComponent(n.currentAlbum)}/${o}`,c=document.createElement("link");c.rel="preload",c.as="image",c.imageSrcset=D(r,[800,1200,1920],85),c.imageSizes="100vw",document.head.appendChild(c)}}function K(n,t,a){n/=255,t/=255,a/=255;const l=Math.max(n,t,a),s=Math.min(n,t,a);let o,r,c=(l+s)/2;if(l===s)o=r=0;else{const i=l-s;switch(r=c>.5?i/(2-l-s):i/(l+s),l){case n:o=((t-a)/i+(t<a?6:0))/6;break;case t:o=((a-n)/i+2)/6;break;case a:o=((n-t)/i+4)/6;break}}return{h:Math.round(o*360),s:Math.round(r*100),l:Math.round(c*100)}}function U(n){console.log("applyAmbientLighting called",n);const t=document.createElement("canvas"),a=t.getContext("2d");t.width=50,t.height=50,a.drawImage(n,0,0,50,50);try{const s=a.getImageData(0,0,50,50).data;let o=0,r=0,c=0,i=0;for(let u=0;u<s.length;u+=4)o+=s[u],r+=s[u+1],c+=s[u+2],i++;o=Math.floor(o/i),r=Math.floor(r/i),c=Math.floor(c/i),console.log("Average RGB:",o,r,c);const h=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;console.log("Dark mode:",h);const d=K(o,r,c);console.log("Original HSL:",d),h?(d.s=Math.min(d.s*.3,12),d.l=Math.min(d.l*.2,10)):(d.s=Math.min(d.s*.5,25),d.l=Math.max(98-d.l*.15,88)),console.log("Adjusted HSL:",d);const m=`hsl(${d.h}, ${d.s}%, ${d.l}%)`;console.log("Applying color:",m),document.body.style.transition="background-color 0.4s ease",document.body.style.setProperty("background-color",m,"important");const b=document.getElementById("photo-overlay");b&&b.style.setProperty("background-color",m,"important"),console.log("Body background-color after set:",document.body.style.backgroundColor)}catch(l){console.warn("Could not extract color for ambient lighting:",l)}}function _(){document.body.style.transition="background-color 0.4s ease",document.body.style.backgroundColor=""}function z(n){e.scrollPosition=window.scrollY,e.currentAlbum=n,e.currentPhoto=1,e.view="viewer",e.navVisible=!0,x()}function F(){const n=e.searchQuery.toLowerCase();document.querySelectorAll("#album-list li").forEach(a=>{const l=a.dataset.albumId.toLowerCase(),s=a.dataset.albumName;!n||s.includes(n)||l.includes(n)?a.classList.remove("hidden"):a.classList.add("hidden")})}function X(){document.querySelectorAll("#album-list li").forEach(t=>{const a=t.querySelector("img"),l=t.querySelector(".text-stone-500");parseInt(t.dataset.albumIndex)===e.selectedAlbumIndex?(a&&(a.classList.remove("outline-transparent"),a.classList.add("outline","outline-stone-800","dark:outline-stone-100")),l&&(l.classList.remove("sm:opacity-0"),l.classList.add("opacity-100"))):(a&&(a.classList.add("outline-transparent"),a.classList.remove("outline-stone-800","dark:outline-stone-100")),l&&(l.classList.add("sm:opacity-0"),l.classList.remove("opacity-100")))})}function J(){const n=document.querySelectorAll("#album-list li");return Array.from(n).filter(t=>!t.classList.contains("hidden"))}function ee(){const n=window.innerWidth;return n>=1024?6:n>=768?4:n>=640?3:1}function S(n,t=!1){const a=J();if(a.length===0)return;if(e.selectedAlbumIndex===-1)e.selectedAlbumIndex=parseInt(a[0].dataset.albumIndex);else{const s=a.findIndex(o=>parseInt(o.dataset.albumIndex)===e.selectedAlbumIndex);if(s===-1)e.selectedAlbumIndex=parseInt(a[0].dataset.albumIndex);else{let o;if(t){const r=ee();if(o=s+n*r,o<0){const c=s%r;o=Math.floor((a.length-1)/r)*r+c,o>=a.length&&(o=a.length-1)}else o>=a.length&&(o=s%r)}else o=s+n,o<0?o=a.length-1:o>=a.length&&(o=0);e.selectedAlbumIndex=parseInt(a[o].dataset.albumIndex)}}X();const l=a.find(s=>parseInt(s.dataset.albumIndex)===e.selectedAlbumIndex);l&&l.scrollIntoView({behavior:"smooth",block:"nearest"})}function te(){if(e.selectedAlbumIndex===-1)return;const n=document.querySelectorAll("#album-list li"),t=Array.from(n).find(a=>parseInt(a.dataset.albumIndex)===e.selectedAlbumIndex);if(t){const a=t.dataset.albumId;z(a)}}function L(){_(),document.title="Albums by Maxim",document.getElementById("og-title").setAttribute("content","Albums by Maxim"),document.getElementById("og-image").setAttribute("content",""),document.getElementById("og-image-width").setAttribute("content","1200"),document.getElementById("og-image-height").setAttribute("content","630"),document.getElementById("og-url").setAttribute("content",window.location.href);const n=document.getElementById("app");n.innerHTML=`
        <div role="main" aria-label="Photo albums">
            <div class="p-6 grid md:gap-x-10 gap-x-6 sm:gap-y-0 gap-y-6 lg:grid-cols-6 md:grid-cols-4 sm:grid-cols-3 grid-cols-2 border-b border-stone-800 dark:border-stone-400">
              <div class="flex space-x-1 group h-fit">
                <h1><a href="/" class="hover:underline">Albums</a></h1>
                <span class="text-stone-500 sm:opacity-0 group-hover:opacity-100">(${Object.keys(e.albums).length})</span>
              </div>
              <div class="lg:col-span-4 md:col-span-2 col-span-1" role="search">
                <input id="search-input" type="text" placeholder="Search" value="${e.searchQuery}" aria-label="Search albums" class="w-full bg-transparent focus:outline-none focus:underline hover:underline placeholder-stone-800 dark:placeholder-stone-200"/>
              </div>
              <div class="space-y-1 sm:col-span-1 sm:col-start-auto col-start-2" role="navigation" aria-label="Sort options">
                <span class="text-stone-500">Sort by:</span>
                <div>
                    <button id="sort-date-desc" aria-label="Sort albums by newest first" aria-pressed="${e.sortBy==="date-desc"}" class="block ${e.sortBy==="date-desc"?"underline":"hover:underline"}">Newest</button>
                    <button id="sort-date-asc" aria-label="Sort albums by oldest first" aria-pressed="${e.sortBy==="date-asc"}" class="block ${e.sortBy==="date-asc"?"underline":"hover:underline"}">Oldest</button>
                    <button id="sort-name-asc" aria-label="Sort albums alphabetically A to Z" aria-pressed="${e.sortBy==="name-asc"}" class="block ${e.sortBy==="name-asc"?"underline":"hover:underline"}">Name (A-Z)</button>
                    <button id="sort-name-desc" aria-label="Sort albums alphabetically Z to A" aria-pressed="${e.sortBy==="name-desc"}" class="block ${e.sortBy==="name-desc"?"underline":"hover:underline"}">Name (Z-A)</button>
                    <button id="sort-random" aria-label="Sort albums randomly" aria-pressed="${e.sortBy==="random"}" class="block ${e.sortBy==="random"?"underline":"hover:underline"}">Random</button>
                </div>
              </div>
            </div>
            <ul id="album-list" class="px-6 py-12 md:gap-x-10 gap-x-6 gap-y-12 grid lg:grid-cols-6 md:grid-cols-4 sm:grid-cols-3 grid-cols-1 items-end"></ul>
            <div class="p-6 border-t border-stone-800 dark:border-stone-400 grid md:gap-x-10 gap-x-6 sm:gap-y-0 gap-y-6 lg:grid-cols-6 md:grid-cols-4 sm:grid-cols-3 grid-cols-2">
              <span class="lg:col-span-5 md:col-span-3 col-span-1 text-stone-500">(${Object.values(e.albums).reduce((o,r)=>o+r.photos.length,0)})</span>
              <span class="text-stone-500">All Rights Reserved, 2026 Â©</span>
            </div>
        </div>
    `;const t=document.getElementById("album-list");if(Object.keys(e.albums).length===0){t.innerHTML="<li>No albums found</li>";return}const a=document.getElementById("search-input");a.oninput=o=>{e.searchQuery=o.target.value,F()},document.getElementById("sort-name-asc").onclick=()=>{e.sortBy="name-asc",L()},document.getElementById("sort-name-desc").onclick=()=>{e.sortBy="name-desc",L()},document.getElementById("sort-date-desc").onclick=()=>{e.sortBy="date-desc",L()},document.getElementById("sort-date-asc").onclick=()=>{e.sortBy="date-asc",L()},document.getElementById("sort-random").onclick=()=>{e.sortBy="random",L()};let l=Object.entries(e.albums);if(e.sortBy==="random")for(let o=l.length-1;o>0;o--){const r=Math.floor(Math.random()*(o+1));[l[o],l[r]]=[l[r],l[o]]}else l.sort((o,r)=>{const[c,i]=o,[h,d]=r;if(e.sortBy==="name-asc")return i.name.localeCompare(d.name);if(e.sortBy==="name-desc")return d.name.localeCompare(i.name);if(e.sortBy==="date-desc"){const m=i.created?new Date(i.created):new Date(0);return(d.created?new Date(d.created):new Date(0))-m}else if(e.sortBy==="date-asc"){const m=i.created?new Date(i.created):new Date(0),b=d.created?new Date(d.created):new Date(0);return m-b}return 0});l.forEach(([o,r],c)=>{const i=document.createElement("li");i.className="group",i.dataset.albumId=o,i.dataset.albumName=r.name.toLowerCase(),i.dataset.albumIndex=c;const h=document.createElement("a");if(h.href="#",h.className="focus:outline-none",r.photos&&r.photos.length>0){const u=r.photos[0],k=typeof u=="string"?u:u.filename,A=typeof u=="object"&&u.width?u.width:null,g=typeof u=="object"&&u.height?u.height:null,O=A&&g?`${A} / ${g}`:"auto",y=document.createElement("div");y.className="relative mb-4",y.style.aspectRatio=O;const I=document.createElement("div");I.className="absolute inset-0 bg-stone-300 dark:bg-stone-800 opacity-0",y.appendChild(I),setTimeout(()=>{I.classList.remove("opacity-0"),I.classList.add("animate-fade-in")},c*100);const p=document.createElement("img");p.className="relative z-10 w-full h-full object-contain group-hover:outline group-hover:outline-stone-800 dark:group-hover:outline-stone-100 outline outline-transparent opacity-0",p.dataset.albumIndex=c,p.dataset.srcset=D(`/albums/${encodeURIComponent(o)}/${k}`,[200,400,600,800],80),p.dataset.sizes="(max-width: 640px) 50vw, (max-width: 768px) 33vw, 16vw",p.dataset.src=P(`/albums/${encodeURIComponent(o)}/${k}`,{width:400,quality:80,format:"auto"}),p.alt=r.name,p.decoding="async",p.onload=()=>{setTimeout(()=>{p.classList.remove("opacity-0"),p.classList.add("animate-fade-in")},600+c*100)},y.appendChild(p),h.appendChild(y)}const d=document.createElement("div");d.className="flex space-x-1";const m=document.createElement("div");m.textContent=r.name,m.className="group-hover:underline",d.appendChild(m);const b=document.createElement("div");b.className="text-stone-500 sm:opacity-0 group-hover:opacity-100",b.textContent=`(${r.photos.length})`,d.appendChild(b),h.appendChild(d),h.onclick=u=>{u.preventDefault(),z(o)},h.onmouseenter=()=>{r.photos&&r.photos.length>0&&r.photos.slice(0,3).forEach(k=>{const A=typeof k=="string"?k:k.filename,g=document.createElement("link");g.rel="prefetch",g.as="image",g.imageSrcset=D(`/albums/${encodeURIComponent(o)}/${A}`,[800,1200,1920,2560,3840],100),g.imageSizes="100vw",document.head.appendChild(g)})},i.appendChild(h),t.appendChild(i)});const s=new IntersectionObserver((o,r)=>{o.forEach(c=>{if(c.isIntersecting){const i=c.target;i.srcset=i.dataset.srcset,i.sizes=i.dataset.sizes,i.src=i.dataset.src,r.unobserve(i)}})},{rootMargin:"50px"});document.querySelectorAll("#album-list img").forEach(o=>{s.observe(o)}),F(),X(),e.scrollPosition>0&&window.scrollTo({top:e.scrollPosition,behavior:"auto"})}let Z=null;function w(){e.view="index",e.currentAlbum=null,e.currentPhoto=1,e.selectedAlbumIndex=-1,e.navVisible=!0,x()}function q(){const n=e.albums[e.currentAlbum];e.currentPhoto<n.photos.length&&(e.currentPhoto++,x())}function R(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen().catch(n=>{console.warn("Could not enter fullscreen:",n)})}function T(){document.querySelectorAll('#photo-overlay > div[id^="overlay-photo-"]').forEach(t=>{if(parseInt(t.id.replace("overlay-photo-",""))===e.selectedOverlayIndex){t.classList.remove("outline-transparent"),t.classList.add("outline","outline-stone-800","dark:outline-stone-100");const l=t.querySelector("img");l&&l.classList.remove("hover:outline","hover:outline-stone-800","dark:hover:outline-stone-100")}else{t.classList.remove("outline","outline-stone-800","dark:outline-stone-100"),t.classList.add("outline-transparent");const l=t.querySelector("img");l&&l.classList.add("hover:outline","hover:outline-stone-800","dark:hover:outline-stone-100")}})}function oe(){const n=e.albums[e.currentAlbum],t=n.photos[e.currentPhoto-1],a=typeof t=="string"?t:t.filename;e.currentPhoto>=n.photos.length;const l=t&&typeof t=="object"&&t.width?t.width:null,s=t&&typeof t=="object"&&t.height?t.height:null;document.title=`${n.name} | Albums by Maxim`,document.getElementById("og-title").setAttribute("content",`${n.name} | Albums by Maxim`);const o=P(`/albums/${encodeURIComponent(e.currentAlbum)}/${a}`,{width:1200,quality:85,format:"auto"});if(document.getElementById("og-image").setAttribute("content",o),l&&s){const f=Math.min(1200/l,1),v=Math.round(l*f),E=Math.round(s*f);document.getElementById("og-image-width").setAttribute("content",v.toString()),document.getElementById("og-image-height").setAttribute("content",E.toString())}else document.getElementById("og-image-width").setAttribute("content","1200"),document.getElementById("og-image-height").setAttribute("content","630");document.getElementById("og-url").setAttribute("content",window.location.href);const r=l&&s?`${l} / ${s}`:"auto",i=(l&&s?s>l:!1)?"sm:h-[100cqmin] sm:w-auto w-[100cqmin] max-h-full max-w-full":"w-[110cqmin] max-h-full max-w-full",h=`/albums/${encodeURIComponent(e.currentAlbum)}/${a}`,d=document.getElementById("app");d.innerHTML=`
        <div>
            <!-- Loading progress bar -->
            <div class="fixed top-0 left-0 w-full h-px z-50">
                <div id="loading-bar" class="h-full bg-black/5 dark:bg-white/10 transition-all duration-150" style="width: 0%"></div>
            </div>

            <div id="top-nav" class="absolute top-0 w-full flex place-content-between px-6 py-6 z-20 transition-opacity duration-[800ms]">
                <div class="flex space-x-1">
                  <button id="back-btn" aria-label="Return to album list" class="hover:underline block">
                    Albums
                  </button>
                  <span class="text-stone-500">/</span>
                  <button id="album-name-btn" aria-label="Toggle fullscreen mode" class="hover:underline"> ${n.name}</button>
                </div>
                <button id="photo-count-btn" aria-label="View all photos in overlay, currently viewing photo ${e.currentPhoto} of ${n.photos.length}" class="text-stone-500 hover:underline flex items-center">
                    (${e.currentPhoto}
                    <span class="text-stone-500">/</span>
                    ${n.photos.length})
                    <span class="ml-1" aria-hidden="true">
                        <svg viewBox="0 0 12 12" fill="currentColor" xmlns="http://www.w3.org/2000/svg" id="More-2-Line--Streamline-Remix" height="12" width="12">
                          <desc>
                            More 2 Line Streamline Icon: https://streamlinehq.com
                          </desc>
                          <path d="M6 1.5c-0.4125 0 -0.75 0.3375 -0.75 0.75S5.5875 3 6 3s0.75 -0.3375 0.75 -0.75S6.4125 1.5 6 1.5Zm0 7.5c-0.4125 0 -0.75 0.3375 -0.75 0.75S5.5875 10.5 6 10.5s0.75 -0.3375 0.75 -0.75S6.4125 9 6 9Zm0 -3.75c-0.4125 0 -0.75 0.3375 -0.75 0.75s0.3375 0.75 0.75 0.75 0.75 -0.3375 0.75 -0.75 -0.3375 -0.75 -0.75 -0.75Z" stroke-width="0.5"></path>
                        </svg>
                    </span>
                </button>
            </div>
            <div class="w-full h-dvh md:p-24 sm:p-12 p-6">
              <div class="w-full h-full relative flex items-center justify-center">
                <div class="relative ${i}" style="aspect-ratio: ${r}; container-type: size;">
                  <div class="w-full h-full bg-black/5 dark:bg-white/10"></div>
                  <img
                      class="absolute inset-0 w-full h-full object-contain opacity-0"
                      id="photo-img"
                      srcset="${D(h,[800,1200,1920],85)}"
                      sizes="100vw"
                      src="${P(h,{width:1920,quality:85,format:"auto"})}"
                      alt="${n.name}, photo ${e.currentPhoto} of ${n.photos.length}"
                      style="cursor: pointer"
                      loading="eager"
                      decoding="async"
                      crossorigin="anonymous"
                  />
                </div>
              </div>
            </div>

            <!-- Photo navigation overlay -->
            <div id="photo-overlay-backdrop" class="fixed inset-0 bg-transparent bg-opacity-0 transition-opacity duration-400 pointer-events-none z-40"></div>
            <div id="photo-overlay" class="fixed top-0 right-0 h-full w-128 sm:w-160 transform translate-x-full transition-all duration-400 z-50 overflow-y-auto p-6 space-y-6">
            </div>
        </div>
    `,document.getElementById("back-btn").onclick=w,document.getElementById("album-name-btn").onclick=R;const m=document.getElementById("top-nav");let b=null;function u(){e.navVisible=!0,m.style.opacity="1",b&&clearTimeout(b),b=setTimeout(()=>{e.navVisible=!1,m.style.opacity="0"},2e3)}m.addEventListener("mouseenter",()=>{u()});const k=f=>{const v=document.getElementById("photo-img"),E=document.getElementById("photo-overlay");f.target!==v&&!E.contains(f.target)&&!v.contains(f.target)&&u()};document.getElementById("app").addEventListener("click",k),e.navVisible?u():m.style.opacity="0";const A=document.getElementById("photo-overlay"),g=document.getElementById("photo-overlay-backdrop");n.photos.forEach((f,v)=>{const E=typeof f=="string"?f:f.filename,B=v+1,V=B===e.currentPhoto,$=document.createElement("div");$.className=`cursor-pointer ${V?"outline outline-stone-800 dark:outline-stone-100":""}`,$.id=`overlay-photo-${B}`;const M=document.createElement("img");M.className="w-full h-auto hover:outline hover:outline-stone-800 dark:hover:outline-stone-100 outline outline-transparent",M.src=P(`/albums/${encodeURIComponent(e.currentAlbum)}/${E}`,{width:200,quality:80,format:"auto"}),M.alt=`Thumbnail ${B} of ${n.photos.length} in ${n.name}`,$.appendChild(M),$.onclick=Q=>{Q.stopPropagation(),e.currentPhoto=B,e.overlayOpen=!1,x()},A.appendChild($)});const O=f=>{e.overlayOpen=f,f?(A.classList.remove("translate-x-full"),g.classList.remove("bg-opacity-0","pointer-events-none"),g.classList.add("bg-opacity-0"),e.selectedOverlayIndex=e.currentPhoto,T(),setTimeout(()=>{const v=document.getElementById(`overlay-photo-${e.currentPhoto}`);v&&v.scrollIntoView({behavior:"auto",block:"center"})},50)):(A.classList.add("translate-x-full"),g.classList.add("bg-opacity-0","pointer-events-none"),g.classList.remove("bg-opacity-50"),e.selectedOverlayIndex=-1)};document.getElementById("photo-count-btn").onclick=()=>O(!0),g.onclick=()=>O(!1);const y=document.getElementById("photo-img"),I=document.getElementById("loading-bar");let p=0,C=15;const j=setInterval(()=>{p>70?C=3:p>50&&(C=8),p+=C,p>90&&(p=90),I.style.width=`${p}%`},50);y.onload=()=>{clearInterval(j),I.style.width="100%",setTimeout(()=>{I.style.opacity="0"},150),y.classList.remove("opacity-0"),y.classList.add("animate-fade-in"),Z=y,U(y)},y.onerror=()=>{clearInterval(j),I.style.width="100%",I.classList.remove("bg-black"),I.classList.add("bg-red-500")},y.onclick=f=>{f.stopPropagation();const v=y.getBoundingClientRect(),E=f.clientX-v.left,B=v.width;E/B<.3?e.currentPhoto===1?w():(e.currentPhoto--,x()):e.currentPhoto>=n.photos.length?w():q()},G(e)}function ne(){return Z}function se(n){window.addEventListener("hashchange",()=>{H(),n()})}function le(n){window.addEventListener("keydown",t=>{const a=document.getElementById("search-input");if(!(a&&document.activeElement===a)){if(e.view==="index")t.key==="ArrowRight"?(t.preventDefault(),S(1,!1)):t.key==="ArrowLeft"?(t.preventDefault(),S(-1,!1)):t.key==="ArrowDown"?(t.preventDefault(),S(1,!0)):t.key==="ArrowUp"?(t.preventDefault(),S(-1,!0)):t.key==="Enter"?(t.preventDefault(),te(),n()):t.key==="f"||t.key==="F"?(t.preventDefault(),R()):(t.key==="i"||t.key==="I")&&(t.preventDefault(),w(),n());else if(e.view==="viewer"){const l=e.albums[e.currentAlbum];if(t.key===" "){t.preventDefault();const s=document.getElementById("photo-overlay");!s.classList.contains("translate-x-full")?(s.classList.add("translate-x-full"),document.getElementById("photo-overlay-backdrop").classList.add("bg-opacity-0","pointer-events-none"),e.overlayOpen=!1,e.selectedOverlayIndex=-1):(s.classList.remove("translate-x-full"),document.getElementById("photo-overlay-backdrop").classList.remove("bg-opacity-0","pointer-events-none"),e.overlayOpen=!0,e.selectedOverlayIndex=e.currentPhoto,T(),setTimeout(()=>{const c=document.getElementById(`overlay-photo-${e.selectedOverlayIndex}`);c&&c.scrollIntoView({behavior:"auto",block:"center"})},50))}else if(e.overlayOpen&&(t.key==="ArrowDown"||t.key==="ArrowUp")){t.preventDefault();const s=t.key==="ArrowDown"?1:-1,o=e.selectedOverlayIndex+s;if(o>=1&&o<=l.photos.length){e.selectedOverlayIndex=o,T();const r=document.getElementById(`overlay-photo-${e.selectedOverlayIndex}`);r&&r.scrollIntoView({behavior:"smooth",block:"nearest"})}}else e.overlayOpen&&t.key==="Enter"?(t.preventDefault(),e.selectedOverlayIndex>=1&&e.selectedOverlayIndex<=l.photos.length&&(e.currentPhoto=e.selectedOverlayIndex,e.overlayOpen=!1,e.selectedOverlayIndex=-1,x(),n())):t.key==="ArrowRight"?(t.preventDefault(),e.currentPhoto>=l.photos.length?(w(),n()):(q(),n())):t.key==="ArrowLeft"?(t.preventDefault(),e.currentPhoto===1?(w(),n()):(e.currentPhoto--,x(),n())):t.key==="ArrowDown"&&!e.overlayOpen?(t.preventDefault(),w(),n()):t.key==="Escape"?(t.preventDefault(),e.overlayOpen?(document.getElementById("photo-overlay").classList.add("translate-x-full"),document.getElementById("photo-overlay-backdrop").classList.add("bg-opacity-0","pointer-events-none"),e.overlayOpen=!1,e.selectedOverlayIndex=-1):document.fullscreenElement?document.exitFullscreen():(w(),n())):t.key==="f"||t.key==="F"?(t.preventDefault(),R()):t.key==="i"||t.key==="I"?(t.preventDefault(),w(),n()):(t.key==="r"||t.key==="R")&&(t.preventDefault(),e.currentPhoto=1,x(),n())}}})}function ae(n){let t=0,a=0,l=0,s=0,o=!1;window.addEventListener("touchstart",r=>{if(e.view==="viewer"){if(r.touches.length>1){o=!0;return}o=!1,t=r.changedTouches[0].screenX,a=r.changedTouches[0].screenY}}),window.addEventListener("touchmove",r=>{e.view==="viewer"&&r.touches.length>1&&(o=!0)}),window.addEventListener("touchend",r=>{if(e.view!=="viewer"||e.overlayOpen)return;if(o){r.touches.length===0&&(o=!1);return}if(window.visualViewport&&window.visualViewport.scale>1)return;l=r.changedTouches[0].screenX,s=r.changedTouches[0].screenY;const c=e.albums[e.currentAlbum],i=l-t,h=s-a,d=50;let m=!1;Math.abs(i)>Math.abs(h)?Math.abs(i)>d&&(i>0?e.currentPhoto===1?(w(),n()):(e.currentPhoto--,x(),n()):e.currentPhoto>=c.photos.length?(w(),n()):(q(),n())):Math.abs(h)>d&&(document.fullscreenElement?document.exitFullscreen():h<0&&(m=!0,w(),n())),m&&(r.preventDefault(),document.body.style.overflow="hidden",requestAnimationFrame(()=>{document.body.style.overflow=""}))})}function re(){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{const t=ne();t&&e.view==="viewer"&&U(t)})}function N(){e.view==="index"?L():e.view==="viewer"&&oe()}se(N);le(N);ae(N);re();W(N);
