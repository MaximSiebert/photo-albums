(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function a(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(l){if(l.ep)return;l.ep=!0;const o=a(l);fetch(l.href,o)}})();const e={view:"index",currentAlbum:null,currentPhoto:1,albums:{},sortBy:"date-desc",overlayOpen:!1,searchQuery:"",selectedAlbumIndex:-1,navVisible:!0,selectedOverlayIndex:-1};function F(){const n=window.location.hash.slice(1);if(!n){e.view="index",e.currentAlbum=null,e.currentPhoto=1;return}const t=n.split("/");if(t.length===2){const[a,s]=t,l=decodeURIComponent(a),o=parseInt(s,10);e.albums[l]&&o>0&&(e.currentAlbum=l,e.currentPhoto=Math.min(o,e.albums[l].photos.length),e.view="viewer")}}function x(){e.view==="viewer"&&e.currentAlbum?window.location.hash=`${encodeURIComponent(e.currentAlbum)}/${e.currentPhoto}`:window.location.hash=""}async function W(n){try{const a=await(await fetch("./albums/albums.json")).json();for(const s of a.albums)try{const o=await(await fetch(`./albums/${encodeURIComponent(s)}/photos.json`)).json();e.albums[s]={name:o.name||s,photos:o.photos,created:o.created||null}}catch(l){console.error(`Failed to load album ${s}:`,l)}F(),n()}catch(t){console.error("Failed to load albums:",t),document.getElementById("app").innerHTML="<p>Error loading albums. Make sure /albums/albums.json exists.</p>"}}const Y="https://ik.imagekit.io/splitfocus/albums";function P(n,t={}){const{width:a=null,height:s=null,quality:l=85,format:o="auto"}=t,r=[];a&&r.push(`w-${a}`),s&&r.push(`h-${s}`),r.push(`q-${l}`),r.push(`f-${o}`);const i=r.join(",");return`${Y}/tr:${i}${n}`}function D(n,t,a=85){return t.map(s=>`${P(n,{width:s,quality:a,format:"auto"})} ${s}w`).join(", ")}function Z(n){const t=n.albums[n.currentAlbum];if(!(!t||n.currentPhoto>=t.photos.length))for(let a=1;a<=5;a++){const s=n.currentPhoto+a-1;if(s>=t.photos.length)break;const l=t.photos[s];if(!l)continue;const o=typeof l=="string"?l:l.filename,r=`/albums/${encodeURIComponent(n.currentAlbum)}/${o}`,i=document.createElement("link");i.rel="preload",i.as="image",i.imageSrcset=D(r,[800,1200,1920],85),i.imageSizes="100vw",document.head.appendChild(i)}}function G(n,t,a){n/=255,t/=255,a/=255;const s=Math.max(n,t,a),l=Math.min(n,t,a);let o,r,i=(s+l)/2;if(s===l)o=r=0;else{const c=s-l;switch(r=i>.5?c/(2-s-l):c/(s+l),s){case n:o=((t-a)/c+(t<a?6:0))/6;break;case t:o=((a-n)/c+2)/6;break;case a:o=((n-t)/c+4)/6;break}}return{h:Math.round(o*360),s:Math.round(r*100),l:Math.round(i*100)}}function H(n){console.log("applyAmbientLighting called",n);const t=document.createElement("canvas"),a=t.getContext("2d");t.width=50,t.height=50,a.drawImage(n,0,0,50,50);try{const l=a.getImageData(0,0,50,50).data;let o=0,r=0,i=0,c=0;for(let u=0;u<l.length;u+=4)o+=l[u],r+=l[u+1],i+=l[u+2],c++;o=Math.floor(o/c),r=Math.floor(r/c),i=Math.floor(i/c),console.log("Average RGB:",o,r,i);const h=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;console.log("Dark mode:",h);const d=G(o,r,i);console.log("Original HSL:",d),h?(d.s=Math.min(d.s*.3,12),d.l=Math.min(d.l*.2,10)):(d.s=Math.min(d.s*.5,25),d.l=Math.max(98-d.l*.15,88)),console.log("Adjusted HSL:",d);const p=`hsl(${d.h}, ${d.s}%, ${d.l}%)`;console.log("Applying color:",p),document.body.style.transition="background-color 0.4s ease",document.body.style.setProperty("background-color",p,"important");const b=document.getElementById("photo-overlay");b&&b.style.setProperty("background-color",p,"important"),console.log("Body background-color after set:",document.body.style.backgroundColor)}catch(s){console.warn("Could not extract color for ambient lighting:",s)}}function K(){document.body.style.transition="background-color 0.4s ease",document.body.style.backgroundColor=""}function U(n){e.currentAlbum=n,e.currentPhoto=1,e.view="viewer",e.navVisible=!0,x()}function V(){const n=e.searchQuery.toLowerCase();document.querySelectorAll("#album-list li").forEach(a=>{const s=a.dataset.albumId.toLowerCase(),l=a.dataset.albumName;!n||l.includes(n)||s.includes(n)?a.classList.remove("hidden"):a.classList.add("hidden")})}function z(){document.querySelectorAll("#album-list li").forEach(t=>{const a=t.querySelector("img"),s=t.querySelector(".text-stone-500");parseInt(t.dataset.albumIndex)===e.selectedAlbumIndex?(a&&(a.classList.remove("outline-transparent"),a.classList.add("outline","outline-stone-800","dark:outline-stone-100")),s&&(s.classList.remove("sm:opacity-0"),s.classList.add("opacity-100"))):(a&&(a.classList.add("outline-transparent"),a.classList.remove("outline-stone-800","dark:outline-stone-100")),s&&(s.classList.add("sm:opacity-0"),s.classList.remove("opacity-100")))})}function _(){const n=document.querySelectorAll("#album-list li");return Array.from(n).filter(t=>!t.classList.contains("hidden"))}function J(){const n=window.innerWidth;return n>=1024?6:n>=768?4:n>=640?3:1}function M(n,t=!1){const a=_();if(a.length===0)return;if(e.selectedAlbumIndex===-1)e.selectedAlbumIndex=parseInt(a[0].dataset.albumIndex);else{const l=a.findIndex(o=>parseInt(o.dataset.albumIndex)===e.selectedAlbumIndex);if(l===-1)e.selectedAlbumIndex=parseInt(a[0].dataset.albumIndex);else{let o;if(t){const r=J();if(o=l+n*r,o<0){const i=l%r;o=Math.floor((a.length-1)/r)*r+i,o>=a.length&&(o=a.length-1)}else o>=a.length&&(o=l%r)}else o=l+n,o<0?o=a.length-1:o>=a.length&&(o=0);e.selectedAlbumIndex=parseInt(a[o].dataset.albumIndex)}}z();const s=a.find(l=>parseInt(l.dataset.albumIndex)===e.selectedAlbumIndex);s&&s.scrollIntoView({behavior:"smooth",block:"nearest"})}function ee(){if(e.selectedAlbumIndex===-1)return;const n=document.querySelectorAll("#album-list li"),t=Array.from(n).find(a=>parseInt(a.dataset.albumIndex)===e.selectedAlbumIndex);if(t){const a=t.dataset.albumId;U(a)}}function te(){K(),document.title="Albums by Maxim",document.getElementById("og-title").setAttribute("content","Albums by Maxim"),document.getElementById("og-image").setAttribute("content",""),document.getElementById("og-image-width").setAttribute("content","1200"),document.getElementById("og-image-height").setAttribute("content","630"),document.getElementById("og-url").setAttribute("content",window.location.href);const n=document.getElementById("app");n.innerHTML=`
        <div>
            <div class="p-6 grid md:gap-x-10 gap-x-6 sm:gap-y-0 gap-y-6 lg:grid-cols-6 md:grid-cols-4 sm:grid-cols-3 grid-cols-2 border-b border-stone-800 dark:border-stone-400">
              <div class="flex space-x-1 group h-fit">
                <h1><a href="/photo-albums" class="hover:underline">Albums</a></h1>
                <span class="text-stone-500 sm:opacity-0 group-hover:opacity-100">(${Object.keys(e.albums).length})</span>
              </div>
              <div class="lg:col-span-4 md:col-span-2 col-span-1">
                <input id="search-input" type="text" placeholder="Search" value="${e.searchQuery}" class="w-full bg-transparent focus:outline-none focus:underline placeholder-stone-800 dark:placeholder-stone-200"/>
              </div>
              <div class="space-y-1 sm:col-span-1 sm:col-start-auto col-start-2">
                <span>Sort by:</span>
                <div>
                    <button id="sort-date-desc" class="block ${e.sortBy==="date-desc"?"underline":"hover:underline"}">Newest</button>
                    <button id="sort-date-asc" class="block ${e.sortBy==="date-asc"?"underline":"hover:underline"}">Oldest</button>
                    <button id="sort-name-asc" class="block ${e.sortBy==="name-asc"?"underline":"hover:underline"}">Name (A-Z)</button>
                    <button id="sort-name-desc" class="block ${e.sortBy==="name-desc"?"underline":"hover:underline"}">Name (Z-A)</button>
                    <button id="sort-random" class="block ${e.sortBy==="random"?"underline":"hover:underline"}">Random</button>
                </div>
              </div>
            </div>
            <ul id="album-list" class="px-6 py-12 md:gap-x-10 gap-x-6 gap-y-12 grid lg:grid-cols-6 md:grid-cols-4 sm:grid-cols-3 grid-cols-1 items-end"></ul>
            <div class="p-6 border-t border-stone-800 dark:border-stone-400 grid md:gap-x-10 gap-x-6 sm:gap-y-0 gap-y-6 lg:grid-cols-6 md:grid-cols-4 sm:grid-cols-3 grid-cols-2">
              <span class="lg:col-span-5 md:col-span-3 col-span-1 text-stone-500">(${Object.values(e.albums).reduce((o,r)=>o+r.photos.length,0)})</span>
              <span class="text-stone-500">All Rights Reserved, 2026 Â©</span>
            </div>
        </div>
    `;const t=document.getElementById("album-list");if(Object.keys(e.albums).length===0){t.innerHTML="<li>No albums found</li>";return}const a=document.getElementById("search-input");a.oninput=o=>{e.searchQuery=o.target.value,V()},document.getElementById("sort-name-asc").onclick=()=>{e.sortBy="name-asc"},document.getElementById("sort-name-desc").onclick=()=>{e.sortBy="name-desc"},document.getElementById("sort-date-desc").onclick=()=>{e.sortBy="date-desc"},document.getElementById("sort-date-asc").onclick=()=>{e.sortBy="date-asc"},document.getElementById("sort-random").onclick=()=>{e.sortBy="random"};let s=Object.entries(e.albums);if(e.sortBy==="random")for(let o=s.length-1;o>0;o--){const r=Math.floor(Math.random()*(o+1));[s[o],s[r]]=[s[r],s[o]]}else s.sort((o,r)=>{const[i,c]=o,[h,d]=r;if(e.sortBy==="name-asc")return c.name.localeCompare(d.name);if(e.sortBy==="name-desc")return d.name.localeCompare(c.name);if(e.sortBy==="date-desc"){const p=c.created?new Date(c.created):new Date(0);return(d.created?new Date(d.created):new Date(0))-p}else if(e.sortBy==="date-asc"){const p=c.created?new Date(c.created):new Date(0),b=d.created?new Date(d.created):new Date(0);return p-b}return 0});s.forEach(([o,r],i)=>{const c=document.createElement("li");c.className="group",c.dataset.albumId=o,c.dataset.albumName=r.name.toLowerCase(),c.dataset.albumIndex=i;const h=document.createElement("a");if(h.href="#",h.className="focus:outline-none",r.photos&&r.photos.length>0){const u=r.photos[0],k=typeof u=="string"?u:u.filename,A=typeof u=="object"&&u.width?u.width:null,g=typeof u=="object"&&u.height?u.height:null,$=A&&g?`${A} / ${g}`:"auto",y=document.createElement("div");y.className="relative mb-4",y.style.aspectRatio=$;const I=document.createElement("div");I.className="absolute inset-0 bg-stone-300 dark:bg-stone-800 opacity-0",y.appendChild(I),setTimeout(()=>{I.classList.remove("opacity-0"),I.classList.add("animate-fade-in")},i*100);const m=document.createElement("img");m.className="relative z-10 w-full h-full object-contain group-hover:outline group-hover:outline-stone-800 dark:group-hover:outline-stone-100 outline outline-transparent opacity-0",m.dataset.albumIndex=i,m.dataset.srcset=D(`/albums/${encodeURIComponent(o)}/${k}`,[200,400,600,800],80),m.dataset.sizes="(max-width: 640px) 50vw, (max-width: 768px) 33vw, 16vw",m.dataset.src=P(`/albums/${encodeURIComponent(o)}/${k}`,{width:400,quality:80,format:"auto"}),m.alt=r.name,m.decoding="async",m.onload=()=>{setTimeout(()=>{m.classList.remove("opacity-0"),m.classList.add("animate-fade-in")},600+i*100)},y.appendChild(m),h.appendChild(y)}const d=document.createElement("div");d.className="flex space-x-1";const p=document.createElement("div");p.textContent=r.name,p.className="group-hover:underline",d.appendChild(p);const b=document.createElement("div");b.className="text-stone-500 sm:opacity-0 group-hover:opacity-100",b.textContent=`(${r.photos.length})`,d.appendChild(b),h.appendChild(d),h.onclick=u=>{u.preventDefault(),U(o)},h.onmouseenter=()=>{r.photos&&r.photos.length>0&&r.photos.slice(0,3).forEach(k=>{const A=typeof k=="string"?k:k.filename,g=document.createElement("link");g.rel="prefetch",g.as="image",g.imageSrcset=D(`/albums/${encodeURIComponent(o)}/${A}`,[800,1200,1920,2560,3840],100),g.imageSizes="100vw",document.head.appendChild(g)})},c.appendChild(h),t.appendChild(c)});const l=new IntersectionObserver((o,r)=>{o.forEach(i=>{if(i.isIntersecting){const c=i.target;c.srcset=c.dataset.srcset,c.sizes=c.dataset.sizes,c.src=c.dataset.src,r.unobserve(c)}})},{rootMargin:"50px"});document.querySelectorAll("#album-list img").forEach(o=>{l.observe(o)}),V(),z()}let X=null;function w(){e.view="index",e.currentAlbum=null,e.currentPhoto=1,e.selectedAlbumIndex=-1,e.navVisible=!0,x()}function q(){const n=e.albums[e.currentAlbum];e.currentPhoto<n.photos.length&&(e.currentPhoto++,x())}function C(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen().catch(n=>{console.warn("Could not enter fullscreen:",n)})}function R(){document.querySelectorAll('#photo-overlay > div[id^="overlay-photo-"]').forEach(t=>{if(parseInt(t.id.replace("overlay-photo-",""))===e.selectedOverlayIndex){t.classList.remove("outline-transparent"),t.classList.add("outline","outline-stone-800","dark:outline-stone-100");const s=t.querySelector("img");s&&s.classList.remove("hover:outline","hover:outline-stone-800","dark:hover:outline-stone-100")}else{t.classList.remove("outline","outline-stone-800","dark:outline-stone-100"),t.classList.add("outline-transparent");const s=t.querySelector("img");s&&s.classList.add("hover:outline","hover:outline-stone-800","dark:hover:outline-stone-100")}})}function oe(){const n=e.albums[e.currentAlbum],t=n.photos[e.currentPhoto-1],a=typeof t=="string"?t:t.filename;e.currentPhoto>=n.photos.length;const s=t&&typeof t=="object"&&t.width?t.width:null,l=t&&typeof t=="object"&&t.height?t.height:null;document.title=`${n.name} | Albums by Maxim`,document.getElementById("og-title").setAttribute("content",`${n.name} | Albums by Maxim`);const o=P(`/albums/${encodeURIComponent(e.currentAlbum)}/${a}`,{width:1200,quality:85,format:"auto"});if(document.getElementById("og-image").setAttribute("content",o),s&&l){const f=Math.min(1200/s,1),v=Math.round(s*f),E=Math.round(l*f);document.getElementById("og-image-width").setAttribute("content",v.toString()),document.getElementById("og-image-height").setAttribute("content",E.toString())}else document.getElementById("og-image-width").setAttribute("content","1200"),document.getElementById("og-image-height").setAttribute("content","630");document.getElementById("og-url").setAttribute("content",window.location.href);const r=s&&l?`${s} / ${l}`:"auto",c=(s&&l?l>s:!1)?"sm:h-[100cqmin] sm:w-auto w-[100cqmin] max-h-full max-w-full":"w-[110cqmin] max-h-full max-w-full",h=`/albums/${encodeURIComponent(e.currentAlbum)}/${a}`,d=document.getElementById("app");d.innerHTML=`
        <div>
            <!-- Loading progress bar -->
            <div class="fixed top-0 left-0 w-full h-px z-50">
                <div id="loading-bar" class="h-full bg-black/5 dark:bg-white/10 transition-all duration-150" style="width: 0%"></div>
            </div>

            <div id="top-nav" class="absolute top-0 w-full flex place-content-between px-6 py-6 z-20 transition-opacity duration-[800ms]">
                <div class="flex space-x-1">
                  <button id="back-btn" class="hover:underline block">
                    Albums
                  </button>
                  <span class="text-stone-500">/</span>
                  <button id="album-name-btn" class="hover:underline"> ${n.name}</button>
                </div>
                <button id="photo-count-btn" class="text-stone-500 hover:underline flex items-center">
                    (${e.currentPhoto}
                    <span class="text-stone-500">/</span>
                    ${n.photos.length})
                    <span class="ml-1">
                        <svg viewBox="0 0 12 12" fill="currentColor" xmlns="http://www.w3.org/2000/svg" id="More-2-Line--Streamline-Remix" height="12" width="12">
                          <desc>
                            More 2 Line Streamline Icon: https://streamlinehq.com
                          </desc>
                          <path d="M6 1.5c-0.4125 0 -0.75 0.3375 -0.75 0.75S5.5875 3 6 3s0.75 -0.3375 0.75 -0.75S6.4125 1.5 6 1.5Zm0 7.5c-0.4125 0 -0.75 0.3375 -0.75 0.75S5.5875 10.5 6 10.5s0.75 -0.3375 0.75 -0.75S6.4125 9 6 9Zm0 -3.75c-0.4125 0 -0.75 0.3375 -0.75 0.75s0.3375 0.75 0.75 0.75 0.75 -0.3375 0.75 -0.75 -0.3375 -0.75 -0.75 -0.75Z" stroke-width="0.5"></path>
                        </svg>
                    </span>
                </button>
            </div>
            <div class="w-full h-dvh md:p-24 sm:p-12 p-6">
              <div class="w-full h-full relative flex items-center justify-center">
                <div class="relative ${c}" style="aspect-ratio: ${r}; container-type: size;">
                  <div class="w-full h-full bg-black/5 dark:bg-white/10"></div>
                  <img
                      class="absolute inset-0 w-full h-full object-contain opacity-0"
                      id="photo-img"
                      srcset="${D(h,[800,1200,1920],85)}"
                      sizes="100vw"
                      src="${P(h,{width:1920,quality:85,format:"auto"})}"
                      alt="Photo ${e.currentPhoto}"
                      style="cursor: pointer"
                      loading="eager"
                      decoding="async"
                      crossorigin="anonymous"
                  />
                </div>
              </div>
            </div>

            <!-- Photo navigation overlay -->
            <div id="photo-overlay-backdrop" class="fixed inset-0 bg-transparent bg-opacity-0 transition-opacity duration-400 pointer-events-none z-40"></div>
            <div id="photo-overlay" class="fixed top-0 right-0 h-full w-128 sm:w-160 transform translate-x-full transition-all duration-400 z-50 overflow-y-auto p-6 space-y-6">
            </div>
        </div>
    `,document.getElementById("back-btn").onclick=w,document.getElementById("album-name-btn").onclick=C;const p=document.getElementById("top-nav");let b=null;function u(){e.navVisible=!0,p.style.opacity="1",b&&clearTimeout(b),b=setTimeout(()=>{e.navVisible=!1,p.style.opacity="0"},2e3)}p.addEventListener("mouseenter",()=>{u()});const k=f=>{const v=document.getElementById("photo-img"),E=document.getElementById("photo-overlay");f.target!==v&&!E.contains(f.target)&&!v.contains(f.target)&&u()};document.getElementById("app").addEventListener("click",k),e.navVisible?u():p.style.opacity="0";const A=document.getElementById("photo-overlay"),g=document.getElementById("photo-overlay-backdrop");n.photos.forEach((f,v)=>{const E=typeof f=="string"?f:f.filename,L=v+1,j=L===e.currentPhoto,B=document.createElement("div");B.className=`cursor-pointer ${j?"outline outline-stone-800 dark:outline-stone-100":""}`,B.id=`overlay-photo-${L}`;const O=document.createElement("img");O.className="w-full h-auto hover:outline hover:outline-stone-800 dark:hover:outline-stone-100 outline outline-transparent",O.src=P(`/albums/${encodeURIComponent(e.currentAlbum)}/${E}`,{width:200,quality:80,format:"auto"}),O.alt=`Photo ${L}`,B.appendChild(O),B.onclick=Q=>{Q.stopPropagation(),e.currentPhoto=L,e.overlayOpen=!1,x()},A.appendChild(B)});const $=f=>{e.overlayOpen=f,f?(A.classList.remove("translate-x-full"),g.classList.remove("bg-opacity-0","pointer-events-none"),g.classList.add("bg-opacity-0"),e.selectedOverlayIndex=e.currentPhoto,R(),setTimeout(()=>{const v=document.getElementById(`overlay-photo-${e.currentPhoto}`);v&&v.scrollIntoView({behavior:"auto",block:"center"})},50)):(A.classList.add("translate-x-full"),g.classList.add("bg-opacity-0","pointer-events-none"),g.classList.remove("bg-opacity-50"),e.selectedOverlayIndex=-1)};document.getElementById("photo-count-btn").onclick=()=>$(!0),g.onclick=()=>$(!1);const y=document.getElementById("photo-img"),I=document.getElementById("loading-bar");let m=0,N=15;const T=setInterval(()=>{m>70?N=3:m>50&&(N=8),m+=N,m>90&&(m=90),I.style.width=`${m}%`},50);y.onload=()=>{clearInterval(T),I.style.width="100%",setTimeout(()=>{I.style.opacity="0"},150),y.classList.remove("opacity-0"),y.classList.add("animate-fade-in"),X=y,H(y)},y.onerror=()=>{clearInterval(T),I.style.width="100%",I.classList.remove("bg-black"),I.classList.add("bg-red-500")},y.onclick=f=>{f.stopPropagation();const v=y.getBoundingClientRect(),E=f.clientX-v.left,L=v.width;E/L<.3?e.currentPhoto===1?w():(e.currentPhoto--,x()):e.currentPhoto>=n.photos.length?w():q()},Z(e)}function ne(){return X}function se(n){window.addEventListener("hashchange",()=>{F(),n()})}function le(n){window.addEventListener("keydown",t=>{if(e.view==="index")t.key==="ArrowRight"?(t.preventDefault(),M(1,!1)):t.key==="ArrowLeft"?(t.preventDefault(),M(-1,!1)):t.key==="ArrowDown"?(t.preventDefault(),M(1,!0)):t.key==="ArrowUp"?(t.preventDefault(),M(-1,!0)):t.key==="Enter"?(t.preventDefault(),ee(),n()):t.key==="f"||t.key==="F"?(t.preventDefault(),C()):(t.key==="i"||t.key==="I")&&(t.preventDefault(),w(),n());else if(e.view==="viewer"){const a=e.albums[e.currentAlbum];if(t.key===" "){t.preventDefault();const s=document.getElementById("photo-overlay");!s.classList.contains("translate-x-full")?(s.classList.add("translate-x-full"),document.getElementById("photo-overlay-backdrop").classList.add("bg-opacity-0","pointer-events-none"),e.overlayOpen=!1,e.selectedOverlayIndex=-1):(s.classList.remove("translate-x-full"),document.getElementById("photo-overlay-backdrop").classList.remove("bg-opacity-0","pointer-events-none"),e.overlayOpen=!0,e.selectedOverlayIndex=e.currentPhoto,R(),setTimeout(()=>{const r=document.getElementById(`overlay-photo-${e.selectedOverlayIndex}`);r&&r.scrollIntoView({behavior:"auto",block:"center"})},50))}else if(e.overlayOpen&&(t.key==="ArrowDown"||t.key==="ArrowUp")){t.preventDefault();const s=t.key==="ArrowDown"?1:-1,l=e.selectedOverlayIndex+s;if(l>=1&&l<=a.photos.length){e.selectedOverlayIndex=l,R();const o=document.getElementById(`overlay-photo-${e.selectedOverlayIndex}`);o&&o.scrollIntoView({behavior:"smooth",block:"nearest"})}}else e.overlayOpen&&t.key==="Enter"?(t.preventDefault(),e.selectedOverlayIndex>=1&&e.selectedOverlayIndex<=a.photos.length&&(e.currentPhoto=e.selectedOverlayIndex,e.overlayOpen=!1,e.selectedOverlayIndex=-1,x(),n())):t.key==="ArrowRight"?(t.preventDefault(),e.currentPhoto>=a.photos.length?(w(),n()):(q(),n())):t.key==="ArrowLeft"?(t.preventDefault(),e.currentPhoto===1?(w(),n()):(e.currentPhoto--,x(),n())):t.key==="ArrowDown"&&!e.overlayOpen?(t.preventDefault(),w(),n()):t.key==="Escape"?(t.preventDefault(),e.overlayOpen?(document.getElementById("photo-overlay").classList.add("translate-x-full"),document.getElementById("photo-overlay-backdrop").classList.add("bg-opacity-0","pointer-events-none"),e.overlayOpen=!1,e.selectedOverlayIndex=-1):document.fullscreenElement?document.exitFullscreen():(w(),n())):t.key==="f"||t.key==="F"?(t.preventDefault(),C()):t.key==="i"||t.key==="I"?(t.preventDefault(),w(),n()):(t.key==="r"||t.key==="R")&&(t.preventDefault(),e.currentPhoto=1,x(),n())}})}function ae(n){let t=0,a=0,s=0,l=0;window.addEventListener("touchstart",o=>{e.view==="viewer"&&(t=o.changedTouches[0].screenX,a=o.changedTouches[0].screenY)}),window.addEventListener("touchend",o=>{if(e.view!=="viewer"||e.overlayOpen)return;s=o.changedTouches[0].screenX,l=o.changedTouches[0].screenY;const r=e.albums[e.currentAlbum],i=s-t,c=l-a,h=50;Math.abs(i)>Math.abs(c)?Math.abs(i)>h&&(i>0?e.currentPhoto===1?(w(),n()):(e.currentPhoto--,x(),n()):e.currentPhoto>=r.photos.length?(w(),n()):(q(),n())):Math.abs(c)>h&&(document.fullscreenElement?document.exitFullscreen():c<0&&(w(),n()))})}function re(){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{const t=ne();t&&e.view==="viewer"&&H(t)})}function S(){e.view==="index"?te():e.view==="viewer"&&oe()}se(S);le(S);ae(S);re();W(S);
